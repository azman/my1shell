#!/bin/bash

# slack-update
# - written by azman@my1matrix.net
# - get updates for slackware system
# - requires getslack, getslackpack, getslackbuild scripts

# standard tool info
TOOL_NAME="my1 Slackware Update Tool"
TOOL_VERS="2019.07.00"
TOOL_BASE=`basename $0`
TOOL_PATH=`dirname $0`
TOOL_PATH=`cd $TOOL_PATH ; pwd`
CURR_PATH=`pwd`

echo -e "\n$TOOL_BASE - $TOOL_NAME ($TOOL_VERS)\n"

# find libmy1slack
TLIB_NAME="libmy1slack"
TLIB_FULL=$TOOL_PATH/$TLIB_NAME
[ ! -f "$TLIB_FULL" ] &&
	echo "Cannot find '$TLIB_FULL'! Aborting!" && exit 1
. $TLIB_FULL

# make sure we are in correct path
call_setup
[ ! -d "$SLACKTREE" ] &&
	echo "Cannot find tree path '$SLACKTREE'! Aborting!" && exit 1
NEXT_PATH=`dirname $SLACKTREE`
cd $NEXT_PATH

$TOOL_PATH/getslack
$TOOL_PATH/getslackpack --sweep --exec
$TOOL_PATH/getslackbuild -a

if [ -d /opt/chroot32 ] ; then
	ARCH=x86 $TOOL_PATH/getslack
	ARCH=x86 $TOOL_PATH/getslackpack --sweep --exec
fi

cd $CURR_PATH
echo ; exit 0
